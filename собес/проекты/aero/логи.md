В таком проекте логирование обычно делится на **два слоя**:  
операционные логи сервисов и метрики/алерты. Интервьюеру важно услышать, что ты понимаешь не только «мы писали в файл», а полный цикл — _где пишется, как собирается, где хранится и как используется_.

---

## 1. Где формируются логи

Каждый backend-сервис (Auth, Game, Leaderboard, WebSocket) пишет **структурированные JSON-логи** в stdout контейнера.

Почему stdout:

- Docker/Kubernetes сам их подхватывает,
    
- не нужно управлять файлами,
    
- проще масштабирование.
    

Формат примерно такой:

```
{
  "timestamp": "...",
  "level": "info",
  "service": "game",
  "user_id": 123,
  "action": "session_processed",
  "score": 540
}
```

Не строки, а JSON — чтобы потом удобно фильтровать.

---

## 2. Что логируется

### Info

- вход запроса,
    
- обработка сессии,
    
- обновление лидерборда,
    
- подключение WebSocket.
    

### Warning

- подозрительные значения score,
    
- повторные session_id,
    
- превышение лимитов.
    

### Error

- падение БД,
    
- Redis timeout,
    
- ошибки валидации,
    
- panic.
    

---

## 3. Как собираются логи

Обычно схема такая:

**Service → stdout → лог-агент → хранилище логов**

Лог-агент:

- Fluent Bit  
    или
    
- Promtail
    

Он читает stdout контейнеров и отправляет данные дальше.

---

## 4. Где хранятся логи

### Вариант 1 — Loki + Grafana

Самый популярный для микросервисов.

- Loki хранит логи (сжатые, дешёвые).
    
- Grafana — просмотр и поиск.
    

Объём:

- несколько гигабайт за кампанию.
    

Retention:

- 7–30 дней.
    

---

### Вариант 2 — ELK (Elasticsearch)

Тяжелее, но мощнее.

- Elasticsearch — хранение
    
- Logstash — обработка
    
- Kibana — UI
    

Для промо-игры чаще Loki, потому что дешевле и проще.

---

## 5. Метрики (это уже не логи, но рядом)

Параллельно с логами идут **метрики**:

- Prometheus собирает
    
- Grafana показывает
    

Метрики:

- RPS
    
- latency p95/p99
    
- количество WebSocket соединений
    
- Redis latency
    
- CPU / RAM
    

---

## 6. Когда пишутся логи

Не «на каждый чих», иначе утонешь в данных.

Обычно:

- вход запроса — sampling (например 10%)
    
- ошибки — 100%
    
- подозрительные действия — 100%
    
- фоновые задачи — по завершении
    

---

## 7. Что важно сказать на интервью

Ключевые мысли:

- логи структурированные (JSON);
    
- пишутся в stdout контейнеров;
    
- собираются агентом;
    
- хранятся в Loki/ELK;
    
- есть уровни логирования;
    
- есть retention;
    
- метрики отделены от логов.
    

Короткая формулировка, которая звучит очень уверенно:

> Сервисы писали структурированные JSON-логи в stdout контейнеров, дальше они собирались лог-агентом и отправлялись в Loki, где просматривались через Grafana. Ошибки и предупреждения логировались полностью, информационные события — сэмплировались. Метрики собирались Prometheus’ом отдельно от логов.